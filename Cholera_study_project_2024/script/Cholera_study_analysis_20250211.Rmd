---
title: "Cholera Study Analysis"
author: "Selemani Ngwira"
date: "2025-01-08"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#seleman
if(!require(pacman)) install.packages("pacman")

p_load(
  tidyverse,
  here,
  summarytools,
  janitor,
  sf, 
  tmap,
  OpenStreetMap,
  flextable,
  rio, 
  gtsummary, 
  epikit
)



```

# loading data


```{r}


# importing the data 
cholera_data<- import( here("data/cholera_data_.csv")) %>%
                clean_names()

# changing the data.frame into tibble object for easy handling 
cholera_data<- tibble(cholera_data)



# filtering out those less than 18 years 
cholera_data<-cholera_data %>% 
  filter(age_group!="<18")


ta_shapefile<-st_read(
  here("data/MWI_adm1.shp")
) %>% 
  select(
   NAME_1,
    ID_0,
    ID_1) %>% 
  dplyr::rename(
    "District"= NAME_1
  )



```

# Social and behavioral factors that influence current water treatment practices

## Source of Water for Daily use by District   


```{r pressure, echo=FALSE}







```


## Awareness of the Health Risk Associated with drinking untreated Water by Sex, Age-Group, Level of Education,  and District 

```{r}

awareness_of_heathRisk<-cholera_data %>% 
                 select(
                   sex, 
                   age_group, 
                   level_education, 
                   district,
                   zone,
                   health_risk_associated_with_drinking_untreated_water
                 )


table2<-awareness_of_heathRisk %>% 
          select(-district , -zone) %>% 
            tbl_summary(health_risk_associated_with_drinking_untreated_water,
            percent = "row",
            digits = list(
              sex ~ c(0, 2),
              age_group ~ c(0, 2),
              level_education ~ c(0, 2)
            ))



table2 <- table2 %>% 
         as_flex_table()


save_as_docx(table2, path = here("output/table2.docx"))




sum(str_detect(cholera_data$ta, "TA"))


# tbale of the Zone and District 


table3<-awareness_of_heathRisk %>% 
    mutate(district=recode(
      district, 
      "Blantyre_City"="Blantyre"
    )) %>% 
          select(district , zone, health_risk_associated_with_drinking_untreated_water) %>% 
            tbl_summary(health_risk_associated_with_drinking_untreated_water,
            percent = "row",
            digits = list(
              district~ c(0, 2),
              zone ~ c(0, 2)
            ))


table3 <- table3 %>% 
         as_flex_table()


save_as_docx(table3, path = here("output/table3.docx"))



```





## 2.3. 0 Main sources of drinking water during the dry season by District/ Township 

```{r}



```


## 2.4. 0 Main sources of drinking water during the wet season by District

```{r}



```

## 2.5.1 Water Treatment at Household by Sex, Level of Education, Religion

```{r}




```


## 2.5.2 Water Treatment at Household by District 

```{r}
 

```


## 2.5.3 if yes, Methods of water treatment by District

```{r, fig.height=7, fig.width=14}



 


```

##2.5.4 Properly chlorination process by district.


```{r}




```

## 2.5. 5 Frequency of water treatment by Sex, Level of Education, Religion 

```{r}




```

## 2. 5.6 Access to water treatment by district 

```{r}




```

## 2. 6.0 Knowledge of cholera calendar year.  By Sex, Level of Education, Religion 

```{r}




```


## 2. 7. 0 Knowledge of the potential Cause of Cholera.

```{r}





 
```

## 2.8. 0 Knowledge of the Prevention Measures of cholera by Sex, Level of Education and Religious Belief.  


```{r}





```

## 2.8. 0 Knowledge of the Prevention Measures of cholera by District 
```{r}





```


## 2. 9.0 Current local measures or campaigns in place to prevent cholera outbreaks by Districts
```{r}




```

# Social and cultural behavior determinants of vaccine uptake 


## 3.1. 0 Aware of Cholera Vaccine by  Age- Group, Sex Level of Education, and 3.1. 1 Aware of Cholera Vaccine by  District and Zone  ?? whcih variable is this? ignore the code below




```{r}

table3.1.0 <- cholera_data |> 
            select(ocv_prevent_cholera,age_group,sex,level_education) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              sex ~ c(0, 2),
              age_group ~ c(0, 2),
              level_education ~ c(0, 2)
            ))


 
table3.1.0 <-  table3.1.0 %>% 
         as_flex_table()


save_as_docx( table3.1.0, path = here("output/table3_1_0.docx"))


table3.1.1 <- cholera_data |> 
            select(ocv_prevent_cholera,district,zone) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              district~ c(0, 2),
              zone ~ c(0, 2)
            ))


 
table3.1.1 <-  table3.1.1 %>% 
         as_flex_table()


save_as_docx( table3.1.1, path = here("output/table3_1_1.docx"))


```

## 3.2.0  Believe Cholera Vaccine Prevent Cholera by Sex, Level of Education 

```{r}
table3.2.0 <- cholera_data |> 
            select(ocv_prevent_cholera,age_group,sex,level_education) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              sex ~ c(0, 2),
              age_group ~ c(0, 2),
              level_education ~ c(0, 2)
            ))


 
table3.2.0 <-  table3.2.0 %>% 
         as_flex_table()


save_as_docx( table3.2.0, path = here("output/table3_2_0.docx"))


```

## 3.2.1  Believe Cholera Vaccine Prevent District and Zone 

```{r}

table3.2.1 <- cholera_data |> 
            select(ocv_prevent_cholera,district,zone) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              district~ c(0, 2),
              zone ~ c(0, 2)
            ))


 
table3.2.1 <-  table3.2.1 %>% 
         as_flex_table()


save_as_docx( table3.2.1, path = here("output/table3_2_1.docx"))

```

##3.3. 0 Information about Cholera Vaccine  by Sex, Age Group,  Education, Religion 

```{r}





```



## 3.3. 1 Information about Cholera Vaccine  by  District and Zone 

```{r}
table3.2.1 <- cholera_data |> 
            select(ocv_prevent_cholera,district,zone) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              district~ c(0, 2),
              zone ~ c(0, 2)
            ))


 
table3.2.1 <-  table3.2.1 %>% 
         as_flex_table()


save_as_docx( table3.2.1, path = here("output/table3_2_1.docx"))


```



## 3. 4. 0 Safe of Cholera Vaccine by Sex Age Group Education and Religion 

```{r}

table3.4.0 <- cholera_data %>%
  select(sex, age_group, level_education, religion, safe_vaccine) %>%
  tbl_summary(
    by = safe_vaccine,
    statistic = list(
      sex ~ "{n} ({p}%)",
      age_group ~ "{n} ({p}%)",
      level_education ~ "{n} ({p}%)",
      religion ~ "{n} ({p}%)"
    ),
    digits = list(
      sex ~ c(0, 2),
      age_group ~ c(0, 2),
      level_education ~ c(0, 2),
      religion ~ c(0, 2)
    ),
    percent = "row"
  ) %>%
  modify_header(label = "**Demographic Variable**") %>%
  bold_labels()

# Convert to a flextable for Word export
table_safe_combined <- table3.4.0 %>%
  as_flex_table()

# Save as a Word document
save_as_docx(table3.4.0, path = here("output/table3_4_0.docx"))

table3.4.0
```


##3. 4. 1 Safe of Cholera Vaccine by District and Zone 

```{r}
table3.4.1 <- cholera_data |> 
            select(safe_vaccine,district,zone) %>% 
            tbl_summary(safe_vaccine,
            percent = "row",
            digits = list(
              district~ c(0, 2),
              zone ~ c(0, 2)
            ))


 
table3.4.1 <-  table3.4.1 %>% 
         as_flex_table()


save_as_docx( table3.1.1, path = here("output/table3_4_1.docx"))

table3.4.1


```

## 3. 5. 0 Community Influence decision about vaccination by District and Zone 

```{r}

              


```



## 3. 6. 0 Difficult in access cholera vaccination by Sex, Education and Religion  

```{r}

table3.6.0 <- cholera_data %>%
  select(sex, age_group, level_education, religion, ocv_access) %>%
  tbl_summary(
    by = ocv_access,
    statistic = list(
      sex ~ "{n} ({p}%)",
      age_group ~ "{n} ({p}%)",
      level_education ~ "{n} ({p}%)",
      religion ~ "{n} ({p}%)"
    ),
    digits = list(
      sex ~ c(0, 2),
      age_group ~ c(0, 2),
      level_education ~ c(0, 2),
      religion ~ c(0, 2)
    ),
    percent = "row"
  ) %>%
  modify_header(label = "**Demographic Variable**") %>%
  bold_labels()

# Convert to a flextable for Word export
table_safe_combined <- table3.6.0 %>%
  as_flex_table()

# Save as a Word document
save_as_docx(table3.6.0, path = here("output/table3_6_0.docx"))

table3.6.0





```


## 3. 6. 1 Difficult in access cholera vaccination by District 


```{r}

table3.6.1 <- cholera_data |> 
            select(ocv_prevent_cholera,district) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              district~ c(0, 2)
            ))


 
table3.6.1 <-  table3.6.1 %>% 
         as_flex_table()


save_as_docx( table3.6.1, path = here("output/table3_6_1.docx"))

table3.6.1

```



##3. 7. 0 OCV status by Sex, Age Group, Education and Religious 

```{r}



```


## 3. 8. 0 Family Members vaccinated by District and Zone 
```{r}
table3.6.1 <- cholera_data |> 
            select(ocv_prevent_cholera,district) %>% 
            tbl_summary(ocv_prevent_cholera,
            percent = "row",
            digits = list(
              district~ c(0, 2)
            ))


 
table3.6.1 <-  table3.6.1 %>% 
         as_flex_table()


save_as_docx( table3.6.1, path = here("output/table3_6_1.docx"))

table3.6.1

```


## 3. 9. 0 Willingness to get vaccinated in the Future OCV by Sex, Age Group and Education 

```{r}

```


## 3. 9. 1 Willingness to get vaccinated in the Future OCV by District and Zone 

```{r}

```


## 3. 10. 0 Recommend a Family member to get vaccinated by District and Zone 

```{r}

```



## 3. 13. 0 Prefer ways to Receive Information about Vaccine by Sex, Age Group and Education and Religious 
```{r}

```



## 3. 13. 1 Prefer ways to Receive Information about Vaccine by District and Zone 

```{r}

```







